<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Energia Incidente - IEEE 1584 / Ralph Lee + Fronteira de Segurança</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --azul-primario: #0963c8;
      --azul-secundario: #53aaff;
      --cinza-claro: #f4faff;
      --card-bg: #fff;
      --verde-ok: #23ac2f;
      --vermelho-alerta: #e65b5b;
      --amarelo: #ffd36b;
    }
    body {
      margin: 0;
      background: var(--cinza-claro);
      font-family: 'Segoe UI', Arial, sans-serif;
      color: #203060;
      min-height: 100vh;
    }
    header {
      background: linear-gradient(90deg, var(--azul-primario) 60%, var(--azul-secundario) 100%);
      color: #fff;
      padding: 34px 0 24px 0;
      text-align: center;
      border-radius: 0 0 28px 28px;
      margin-bottom: 32px;
      box-shadow: 0 8px 32px #1558ad20;
    }
    header h1 {
      margin: 0;
      font-size: 2.3em;
      font-weight: bold;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    header .icon {
      font-size: 1.3em;
    }
    .container {
      max-width: 580px;
      margin: 0 auto;
      background: transparent;
      padding: 0 16px 48px 16px;
    }
    .card {
      background: var(--card-bg);
      border-radius: 18px;
      box-shadow: 0 2px 12px #1a5ea522;
      margin-bottom: 32px;
      padding: 26px 26px 20px 26px;
      transition: box-shadow .2s;
    }
    label {
      font-weight: 500;
      display: block;
      margin-bottom: 4px;
      margin-top: 12px;
    }
    input, select {
      width: 100%;
      padding: 9px;
      border: 1px solid #aad4ff;
      border-radius: 8px;
      margin-bottom: 10px;
      font-size: 1.05em;
      background: #f8fbff;
      transition: border-color .2s;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--azul-primario);
      background: #eaf6ff;
    }
    button {
      background: var(--azul-primario);
      color: #fff;
      font-weight: 600;
      font-size: 1.15em;
      border: none;
      padding: 13px 0;
      border-radius: 8px;
      width: 100%;
      cursor: pointer;
      box-shadow: 0 2px 10px #1362c52c;
      transition: background .2s, box-shadow .2s;
      margin-top: 14px;
    }
    button:hover {
      background: var(--azul-secundario);
      box-shadow: 0 4px 20px #1362c54c;
    }
    .resultado-bloco {
      background: linear-gradient(90deg,#eafaff 50%, #d6f8e6 100%);
      border-left: 8px solid var(--azul-primario);
      border-radius: 12px;
      padding: 22px 22px 15px 18px;
      font-size: 1.15em;
      margin-top: 10px;
      margin-bottom: 18px;
      box-shadow: 0 2px 12px #1750a21a;
      line-height: 1.55;
      position: relative;
      z-index: 1;
    }
    .escala {
      width: 100%;
      height: 26px;
      border-radius: 8px;
      background: linear-gradient(90deg, #e5f8e6 0%, #ffd36b 60%, #ff8484 100%);
      margin: 10px 0 16px 0;
      position: relative;
      box-shadow: 0 1px 4px #79c2e922;
    }
    .ponteiro {
      position: absolute;
      top: -7px;
      width: 6px;
      height: 40px;
      border-radius: 3px;
      background: var(--azul-primario);
      left: 0;
      transition: left .3s cubic-bezier(.4,1,.2,1);
      z-index: 2;
    }
    .escala-label {
      position: absolute;
      top: 22px;
      font-size: .92em;
      color: #567;
      opacity: .85;
    }
    .escala-label.left { left: 4px; }
    .escala-label.right { right: 4px; }
    .memorial details summary {
      cursor: pointer;
      font-weight: bold;
      font-size: 1.06em;
      margin-bottom: 8px;
      color: var(--azul-primario);
      outline: none;
    }
    .memorial details[open] summary {
      margin-bottom: 6px;
    }
    .memorial details > div {
      font-size: 0.97em;
      padding-left: 10px;
      color: #234;
    }
    @media (max-width: 680px) {
      .container { padding: 0 2vw; }
      .card { padding: 17px 6vw 14px 6vw;}
    }
  </style>
</head>
<body>
  <header>
    <h1><span class="icon">⚡</span> Energia Incidente IEEE 1584 / Ralph Lee</h1>
  </header>
  <div class="container">
    <div class="card">
      <form id="incidentForm" onsubmit="event.preventDefault();calcularEnergia();">
        <label for="metodo">Metodologia:</label>
        <select id="metodo">
          <option value="ieee">IEEE 1584-2018</option>
          <option value="ralph">Ralph Lee</option>
        </select>
        <label for="voltage">Tensão (V):</label>
        <input type="number" id="voltage" value="480" min="1" required>
        <label for="current">Corrente de Curto (kA):</label>
        <input type="number" step="0.01" id="current" value="25" min="0.1" required>
        <label for="duration">Duração do Arco (s):</label>
        <input type="number" step="0.01" id="duration" value="0.2" min="0.01" required>
        <label for="distance">Distância do trabalhador (mm):</label>
        <input type="number" id="distance" value="610" min="1" required>
        <button type="submit">Calcular Energia Incidente e Fronteira</button>
      </form>
    </div>
    <div id="bloco-resultado" class="resultado-bloco" style="display:none;">
      <div id="result"></div>
      <div id="fronteira"></div>
      <div class="escala" id="scaleBar" style="position:relative;">
        <div id="ponteiro" class="ponteiro" style="left:0"></div>
        <span class="escala-label left">0 cal/cm²</span>
        <span class="escala-label right">&gt;40 cal/cm²</span>
      </div>
    </div>
    <div class="card memorial">
      <details id="detalhesMemorial">
        <summary>Memorial de Cálculo (clique para expandir)</summary>
        <div id="memorial"></div>
      </details>
    </div>
  </div>
  <script>
    function calcularEnergia() {
      // Entradas
      const metodo = document.getElementById('metodo').value;
      const voltage = parseFloat(document.getElementById('voltage').value);
      const current = parseFloat(document.getElementById('current').value);
      const duration = parseFloat(document.getElementById('duration').value);
      const distance = parseFloat(document.getElementById('distance').value);

      let energia = 0, energiaFormula = "", boundary = 0, boundaryFormula = "";
      let memorialExplicacao = "", memorialBoundary = "";
      let classe, epirisco, corClasse;

      if (metodo === "ieee") {
        // IEEE 1584-2018
        // EI = 0.0093 x Icc x V x t / D^0.65
        energia = 0.0093 * current * voltage * duration / Math.pow(distance, 0.65);
        energiaFormula = `EI = 0,0093 × Icc × V × t / D^0,65`;
        // Boundary: EI = 1,2 cal/cm² -> D = [0,0093 × Icc × V × t / 1,2]^(1/0,65)
        let numerador = 0.0093 * current * voltage * duration;
        boundary = Math.pow(numerador / 1.2, 1/0.65);
        boundaryFormula = `D = [0,0093 × Icc × V × t / 1,2]<sup>1/0,65</sup>`;
        memorialExplicacao = `
          <b>IEEE 1584-2018:</b><br>
          EI = Energia incidente (cal/cm²)<br>
          Icc = Corrente de curto (kA)<br>
          V = Tensão (V)<br>
          t = Duração do arco (s)<br>
          D = Distância do trabalhador (mm)<br>
          Expoente 0,65 para baixa tensão<br>
          <b>Fórmula:</b> ${energiaFormula}<br>
        `;
        memorialBoundary = `<b>Fronteira:</b> ${boundaryFormula}<br>
          EI fixado em 1,2 cal/cm² (limite queimadura segundo grau).`;
      } else {
        // Ralph Lee
        // EI = 2.142 x Icc x t / D²
        energia = 2.142 * current * duration / Math.pow(distance,2);
        energiaFormula = `EI = 2,142 × Icc × t / D²`;
        // Boundary: EI = 1,2 cal/cm² -> D = sqrt(2,142 × Icc × t / 1,2)
        boundary = Math.sqrt(2.142 * current * duration / 1.2);
        boundaryFormula = `D = sqrt(2,142 × Icc × t / 1,2)`;
        memorialExplicacao = `
          <b>Ralph Lee (NFPA 70E):</b><br>
          EI = Energia incidente (cal/cm²)<br>
          Icc = Corrente de curto (kA)<br>
          t = Duração do arco (s)<br>
          D = Distância do trabalhador (mm)<br>
          <b>Fórmula:</b> ${energiaFormula}<br>
        `;
        memorialBoundary = `<b>Fronteira:</b> ${boundaryFormula}<br>
          EI fixado em 1,2 cal/cm² (limite queimadura segundo grau).`;
      }

      // Classe de risco e cor (faixas padrão NR10)
      if (energia <= 1.2) { classe = 0; epirisco = "Básico"; corClasse = "#23ac2f"; }
      else if (energia <= 4) { classe = 1; epirisco = "Retardante a chamas"; corClasse = "#aad12b";}
      else if (energia <= 8) { classe = 2; epirisco = "Antichama completo"; corClasse = "#ffb800";}
      else if (energia <= 25) { classe = 3; epirisco = "Classe 3 completo"; corClasse = "#ff8500";}
      else if (energia <= 40) { classe = 4; epirisco = "Classe 4 máximo"; corClasse = "#e65b5b";}
      else { classe = 5; epirisco = "Zona extrema, evacuar área!"; corClasse = "#d12c2c";}

      // Exibir resultado
      document.getElementById('bloco-resultado').style.display = 'block';
      document.getElementById('result').innerHTML = `
        <b>Energia incidente estimada:</b> <span style="color:${corClasse}">${energia.toFixed(2)} cal/cm²</span><br>
        <b>Classe de risco:</b> <span style="color:${corClasse};font-weight:600;font-size:1.08em;">${classe}</span><br>
        <b>EPI recomendado:</b> ${epirisco}
      `;
      document.getElementById('fronteira').innerHTML = `
        <b>Fronteira de segurança:</b>
        <span style="color:${corClasse};font-weight:600">${boundary.toFixed(0)} mm</span>
        <span style="font-size:.97em;color:#234;opacity:.8;">(${(boundary/1000).toFixed(2)} m) para 1,2 cal/cm²</span>
      `;

      // Escala visual
      const energiaDisplay = Math.min(energia, 40);
      const pos = Math.min(energiaDisplay/40, 1) * 100;
      document.getElementById('ponteiro').style.left = `calc(${pos}% - 3px)`;

      // Memorial técnico completo
      document.getElementById('memorial').innerHTML = `
        <b>Entradas:</b><br>
        - Tensão: ${voltage} V<br>
        - Corrente de Curto: ${current} kA<br>
        - Duração do Arco: ${duration} s<br>
        - Distância do trabalhador: ${distance} mm<br><br>
        ${memorialExplicacao}
        <b>Resultado do cálculo:</b><br>
        EI = <b>${energia.toFixed(4)}</b> cal/cm²<br><br>
        ${memorialBoundary}<br>
        Fronteira de segurança: <b>${boundary.toFixed(0)} mm</b> (${(boundary/1000).toFixed(2)} m)<br>
        <span style="font-size:.93em;color:#567;opacity:.8;">Para aplicação real, consulte as tabelas e ajustes dos métodos completos das normas.</span>
      `;
    }
  </script>
</body>
</html>
